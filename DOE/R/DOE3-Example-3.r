
#===============================================================
# Reading Data
#===============================================================
Y1 = c(25.7, 27.2, 29.9, 28.5, 29.4, 28.3)           # Blue
Y2 = c(26.8, 27.9, 23.7, 25, 26.3, 24.8, 25.7, 24.5) # Brown
Y3 = c(26.4, 24.2, 28.0, 26.9, 29.1)                 # Green
Y = c(Y1, Y2, Y3)
n1 = length(Y1); n2 = length(Y2); n3 = length(Y3)    # no. of subjects


################################################################
# CI of mu1
################################################################


# ==============================================================
# CI from t.test()
# ==============================================================
# Bad CI
t.test(Y1)

# ==============================================================
# CI using S1 only 
# ==============================================================
# Same as CI from t.test()
a = 0.05
D = qt(1-a/2,df=n1-1) * sqrt(var(Y1)/n1)
c(mean(Y1)-D, mean(Y1)+D)

# ==============================================================
# CI using MSE (better)
# ==============================================================
# Better CI
a = 0.05; df = n1+n2+n3-3
SSE = sum((Y1-mean(Y1))^2) + sum((Y2-mean(Y2))^2) + sum((Y3-mean(Y3))^2)
MSE = SSE / df
D = qt(1-a/2,df=df) * sqrt(MSE/n1)
c(mean(Y1)-D, mean(Y1)+D)







################################################################
# CI of mu1-mu2 
################################################################

# ==============================================================
# CI from t.test()
# ==============================================================
# Bad CI
t.test(Y1,Y2, var.equal=TRUE)


# ==============================================================
# CI using Sp^2 (with two samples)
# ==============================================================
# Same as CI from t.test()
a = 0.05
Sp2 = ((n1-1)*var(Y1)+(n2-1)*var(Y2))/(n1+n2-2)
D = qt(1-a/2,df=n1+n2-2) * sqrt(Sp2*(1/n1+1/n2))
c(mean(Y1)-mean(Y2)-D, mean(Y1)-mean(Y2)+D)


# ==============================================================
# CI using MSE (better)
# ==============================================================
a = 0.05; df = n1+n2+n3-3
SSE = sum((Y1-mean(Y1))^2) + sum((Y2-mean(Y2))^2) + sum((Y3-mean(Y3))^2)
MSE = SSE / df
D = qt(1-a/2,df=df) * sqrt(MSE*(1/n1+1/n2))
c(mean(Y1)-mean(Y2)-D, mean(Y1)-mean(Y2)+D)



