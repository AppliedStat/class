#======================================================
# Example 9.1.2 on Page 426
#   Test H0: Binomial(n=4, p=1/2) versus H1: not Binomial
#------------------------------------------------------

#------------------------------------------------------
O = c( 7, 18, 40, 31, 4)
n = sum(O) 
E = n * c(1/16, 4/16, 6/16, 4/16, 1/16) 

sum( (O-E)^2 / E )

alpha=0.05
qchisq(1-alpha, df=4) 

#------------------------------------------------------
# Using R function
chisq.test( x=c(7,18,40,31,4), p=c(1/16, 4/16, 6/16, 4/16, 1/16) ) 
chisq.test( x=c(7,18,40,31,4), p=dbinom(0:4, size=4,p=1/2) )
